<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.zjw.springboot.mapper.purchase.ScheduleMapper">

    <resultMap id="schedules" type="cn.com.zjw.springboot.entity.purchase.Schedule">
        <id column="F_ID" property="id" jdbcType="VARCHAR"/>
        <result column="F_SCHEDULENUM" property="scheduleNum" jdbcType="VARCHAR"/>
        <result column="F_STATUS" property="status" jdbcType="VARCHAR"/>
        <result column="F_PLACE" property="place" jdbcType="VARCHAR"/>
        <result column="F_STARTTIME" property="startTime" jdbcType="VARCHAR"/>
        <result column="F_ENDTIME" property="endTime" jdbcType="VARCHAR"/>
    </resultMap>

    <insert id="save">
        INSERT INTO T_SCHEDULE (
            F_ID,
            F_STATUS,
            F_PLACE,
            F_STARTTIME
        ) VALUES (
            #{schedule.id, jdbcType=VARCHAR},
            #{schedule.status, jdbcType=VARCHAR},
            #{schedule.place, jdbcType=VARCHAR},
            to_char(sysdate,'yyyy-mm-dd hh24:mi:ss')
        )
    </insert>

    <update id="update">
        UPDATE
            T_SCHEDULE
        SET
            F_PLACE = #{schedule.place, jdbcType=VARCHAR},
            F_STARTTIME = to_char(sysdate,'yyyy-mm-dd hh24:mi:ss')
        WHERE
            F_ID = #{schedule.id, jdbcType=VARCHAR}
    </update>

    <update id="scheduleEnd">
        UPDATE
            T_SCHEDULE
        SET
            F_STATUS = '1',
            F_ENDTIME = to_char(sysdate,'yyyy-mm-dd hh24:mi:ss')
        WHERE
            F_ID = #{id, jdbcType=VARCHAR}
    </update>

    <select id="getSchedules" resultMap="schedules">
        SELECT
            F_ID,
            F_STATUS,
            F_PLACE,
            F_STARTTIME,
            F_ENDTIME
        FROM
            T_SCHEDULE
        WHERE
        1 = 1
        <if test="schedule.status != null and schedule.status != ''">
            AND F_STATUS = #{schedule.status, jdbcType=VARCHAR}
        </if>
        <if test="schedule.scheduleNum != null and schedule.scheduleNum != ''">
            AND F_ID = #{schedule.scheduleNum, jdbcType=VARCHAR}
        </if>
    </select>

    <select id="getSchedule" resultMap="schedules">
        SELECT
            F_PLACE
        FROM
            T_SCHEDULE
        WHERE
        F_ID = #{id, jdbcType=VARCHAR}
    </select>

</mapper>